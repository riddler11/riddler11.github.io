{"posts":[{"title":"51单片机小车","content":"1.电路设计 首先先选型 在开始前要想好用什么进行控制小车， 该文章如标题： 主控选择：89C52芯片 一辆小车（有两个马达；前马达控制左右，后马达控制前后） 控制马达的芯片或模块：L298/L9110 无线模块：NRF24L01（可采用ESP8266联网控制或者HC05蓝牙控制，看个人喜欢） 降压模块：5V转3.3V（NRF24L01印象中是3.3V） 接下来就是绘制电路图 手绘、软件绘制都行，只要画清楚就行 单片机来讲，最小系统一定要有 接着 开关电源 ，单片机就能工作了 某宝上购置的元器件，本文上的控制马达芯片等，看某宝下面的参考详情 如：L298是怎么连接能够工作等等，弄清楚怎么能工作 那些要用的芯片、模块等连上单片机 记得要留+引出烧写代码的端口，不然每次烧写代码都要把芯片拆下来烧。（万一是贴片主控就很头疼了）。可以使用牛角座+STC免冷启动烧写器（具体烧写器名字我有点忘了，大概这个）进行代码烧写，这样就比较方便。USB转TTL的就需要烧写时候断个电再烧进去。 做好上述步骤可以开始绘制PCB 个人到现在一直用DXP，那就根据自己设计的电路图进行绘制PCB。 当然DXP提供了可以画电路原理图的东西，原理图库，原理图会用可以直接用 画好之后记得一定一定要检查，检查连线有没连好等 打样 交给公司打样，制作出来自己设计的东西 焊接完成后，再进行调试 2.代码调试 ####完成第一部分的电路，并打完样后可以进行实际电路的调试 如果想同步进行代码调试的话，可以用仿真protues 仿真的作用相信大家都不陌生：模拟真实条件下硬件运行的状态，当然模拟这个不能拼出一辆像样的小车，但是里面选型有马达motor。 先调试的是让小车能够动起来 小车能动起来，首先证明小车马达没问题，才能有后面的控制环节。 小车若不能动，那就进行问题排查 或许是马达问题 或许是L298出现问题 也可能是电路板电路一些问题 这时候召唤一下万用表 马达很简单，用块电池正负一接就可以看它会不会动（最好也串个电阻，万一电流过大，这检测过程可能也会烧马达） 其它用万用表测一下有没电什么的【测电流是串进电路（测电流最好也并个电阻，反正我本人就烧过万用表），电压是并联就行】 下一步是进行控制代码调试 设计中是用NRF24L01来控制，那么注意电压 51单片机的电压是5V，这个模块是3.3V 模块烧掉了就不可能控制 假设电脑进行控制，则电脑是信息发送端，单片机是信息接收端 先进行单一控制（如前进，P2.0口是0，P2.1口是1，单片机接收信号“1”） 在电脑用串口调试助手，发送1的信号 单片机的关键代码示例 前进调试成功后就进行下一步举一反三 通过相同方式完成后退，停止，左转，右转控制 ","link":"https://riddler11.github.io/post/51-dan-pian-ji-xiao-che/"},{"title":"ESP8266远程控制台灯","content":"硬件 micro USB USB母座 继电器 电阻电容若干 ESP8266-12F CH340C 硬件电路 ####USB转UART一键下载电路 ####5V转3.3V电路（降压、供电） ####ESP8266-12F主控电路 ####key电路 ####继电器电路 此处设计为了给USB供电充足，避免供电不足灯频闪，加了个电容，利用电容充放电来提供充足电压（这是我个人的想法，不知正确否，实际测试过才行，也欢迎各位读者批评指正） ####总电路原理图 ###2020.8.28翻车部分 板子到了焊接，第一块板在所有焊接完成后，发现CH340C的芯片有问题。早上单独焊接了烧写的电路CH340C，在新版上的烧写电路是没问题的，电脑也能成功识别 由于过于自信，没有多买元件，使得第一板哪里有错误难以检查，而且没有好好核对原理图，买少了元件导致没得焊三个电阻，虽然有最小系统，但是烧录固件ESP12F呈现了十分奇怪的一直闪灯，但不走进程的状态 更多分析可以观看B站同步分享的视频 B站同步的分析视频 ###2020.8.31成功控制台灯 B站观看效果点击这里 自己设计的这块板子理论上能够控制所有采用USB 5V供电的设备 硬件代码部分 1. 先为ESP8266-12F刷入固件（可先刷AT固件，接着刷入nodemcu固件，避免出现错误） 接着写代码，可以用esplorer用lua写代码，或者用arduinoIDE用C语言写代码，本人用C语言比较多，且用arduinoIDE比较多因此选择arduinoIDE 代码思路，先连接WIFI，连上网后连上物联网平台（这里我使用贝壳物联，进行内网穿透，使得外网发信息能够收到），接着写控制代码（这里贝壳物联有demo，再对demo进行修改） 控制软件 自己开发个app或者使用贝壳物联提供的app 这里我用HbuilderX自己开发的app，5+app。简单来说是网站式的app 参考代码部分： ##最后附上软件界面 文件已开源（2020.9.15），码云gitee下载地址:https://gitee.com/riddler11/esp8266-control-desk-lamp/tree/master/ （2020.9.21）在运用到控制台灯上，有些灯会出现频闪的问题。初步分析是由于里面元器件会分压到最后没能达到额定电压导致不能正常工作，需要对电路进行分析计算，以解决这个问题 ","link":"https://riddler11.github.io/post/esp8266-yuan-cheng-kong-zhi-tai-deng/"},{"title":"AD绘制arduino，含原理图及自己遇过的坑","content":"####本人使用的是AD15 ####绘制的是arduino uno板 ####含四个大电路（供电电路，比较电路，usb烧写下载电路和AVR单片机电路） ####比较电路是我觉得是最有意思的部分。通过LM358对USB供电与DC供电相比较，选择有电的那一边 由于身边刚好有个DHT11温湿度传感器，于是决定写一段小代码测试一下 ###遇到的坑 AMS1117-5.0V会降压，DC005用错适配器供电就会使得只有5V电压导致最终只有3.25V（万用表亲测，是电源适配器的问题）。DC005该换用7-12V的供电再使用 用DC002可以把AMS1117-5.0V芯片去掉，或者用DC005适配器是5V的时候亦可以把芯片去掉 绘制原理图库与封装图库，原理图引脚必须要与封装图库里元件引脚相对应，在这基础上要以实际元件的封装引脚对应（就是你要购买的元件） #最最重要的文件下载地址，点击这里去gitee下载 ","link":"https://riddler11.github.io/post/ad-hui-zhi-arduinohan-yuan-li-tu-ji-zi-ji-yu-guo-de-keng/"},{"title":"学习强国打卡系统","content":"该项目纯软件 目前是一个网站的形式来实现学习强国打卡，当初设计是为了提高统计的准确性，以及方便每周值日的同学观看打卡情况，产生做这个系统的想法，目前已经投入使用 ##系统架构 系统架构是基于MVC开发模式拓展的，包括database数据层、model模型层、dao数据持久层、service业务逻辑层、controller/servlet控制器，各层次分工明确，降低层次耦合度。 显示层 (View) 本系统采用B/S模式。多以jsp/html为主要的显示页面，为了满足页面UI的展示，AJAX数据交换为JSON格式。此层与控制层结合比较紧密，需要二者结合起来协同工作。 控制层 Controller层负责具体的业务模块流程的控制，这样不仅使程序结构变得清晰，也大大减少了代码量。 控制层主要用于响应客户端请求，每当请求到系统时，控制层就会调用对应的业务逻辑。请求分多种，如AJAX的数据请求、页面请求、文件上传、文件下载，控制层便会对应地做出相应的数据返回、页面跳转、流返回行为。 数据持久层 DAO层主要是做数据持久层的工作，负责与数据库进行联络的一些任务都封装在此，DAO层的设计首先是设计DAO的接口，然后设计实现类。 ##各层联系 DAO层，可以单独开发，互相的耦合度很低，完全可以独立进行，这样的一种模式在开发大项目的过程中尤其有优势，Controller，View层因为耦合度比较高，因而要结合在一起开发，但是也可以看作一个整体独立于前两个层进行开发。这样，在层与层之间我们只需要知道接口的定义，调用接口即可完成所需要的逻辑单元应用，一切显得非常清晰简单。 ####下图为目前网站功能架构 码云下载地址，直接点击这里，这个代码还是之前有bug时候的代码，看懂里面代码并作相应的修改就会有很大的成长。 这里代码是使用以下软件来进行开发的：开发工具：MyEclipse10，数据库：MySQL 5.1.32-community，图形化界面数据库操作：navicat，Java环境：jdk1.8.0_131（实际可能是jdk6，MyEclipse创建项目时候最高版本） 后来我用eclipse来开发，在myeclipse里那个jdk6换成高版本，一堆叉叉，不换高版本jdk图像处理那里请求的file类那些又没有（具体没有哪些类我忘记了，idea没用过所以没有用），反正看着就很不爽。或者两种jdk存在，导致部分代码出bug；像不执行识别代码什么的。 上述bug 打卡天数，到达99天的时候，加到100，就一直查99天的数据进行修改 打卡天数的流程及实现思路 在积分录入界面，填好分数那些，或者上传图片等待识别，输入框有内容后，点击上传，打卡天数自增 打卡天数，个人设计是通过时间的比较来进行实现的，注册时候会自动记录注册时间，接着打卡就通过与注册时间作比较来计算打卡天数 三种情况： 注册当天打卡 注册当天没打卡 注册后打过卡 具体应结合代码进行看 bug出现的原因是当时设计数据库打卡天数时候，数据类型是varchar（255），然后大家到99天的时候，代码总是判断99为最大的天数。我也懒得改数据库那里设计了，我个人解决这个bug的思路是（判断里面的最新的打卡编号，因为打卡编号自增且数据类型为int）。写到这里，想到支部打卡天数的貌似也是varchar类型，这个我有空再改吧 ##部署在服务器上的bug就精彩多了 本地入数据库没问题，服务器上传中文入数据库就乱码（db.properties里面加useUnicode=true&amp;characterEncoding=UTF-8，解决问题）问题解决链接 tomcat7版本 jdk只有1.7，图像处理的那些算法不能用，如图报错 tomacat8版本终于可以了jdk1.8，结果录入的感想全 ？？？？？（乱码），一查发现tomcat8直接帮你处理好字符的问题 直接默认UTF-8，而我里面的方法为了tomcat7版本转码成ISO-8859-1。后面我决定不改代码，因为懒，太多代码要删删改改调试，于是决定直接浪费tomcat8的美意，把编码改成ISO-8859-1。问题解决链接 4.最精彩部分莫过于这个了。我开发用windows系统，存储目录路径如图 是正斜杠“\\” 然而实际的服务器是Linux系统（怪我看在Linux系统占服务器空间小，所以选择了Linux，否则就不会出现这么精彩的问题了），先看看不改代码放服务器的情况（可看下图） img\\学号\\图片名 （惊喜加意外，就新建了一个奇奇怪怪的文件夹还不能访问），接下来来看服务器实际存储路径 如图 是反斜杠“/”，如此一来存储就出现问题，解决方法改成正斜杠改成反斜杠 ##待提升的地方 积分界面，关于打卡天数可加一个应打卡天数来进行与实际打卡天数作对比。这部分代码方法其实我个人写了，但实际写在前端的时候出现了一点点小问题，现在还不怎么想解决，先凉拌着（不知道咋解决）。 这个网站其实可以转化为微信小程序的形式进行打卡，有能力的同学或者想要拥有这能力的同学可以借鉴我后端写的数据库结构、代码啥的，或者直接将后端的方法链接微信小程序的界面来实现。大佬可以忽略，直接按需开发 图像处理我这里实现是使用别人提供的api，图片数据根据支部的一些图片还有自己实际手机的截图，识别准确率我个人觉得其实可以，识别速率写了延迟3s请求，真正体验有时需要反复上传几次才能识别出来（说实话我还是挺不满意的，没有识别出来会返回上一位识别成功的同学的数据，这是由于我用了个中间变量来存储数据，也算个bug待解决。当时写到崩溃，终于解决识别存数据不入库的方法，后面就有点懒不想写清空上位识别成功数据的代码） 图像处理这部分，有能力其实可以自己写，自己训练识别字库，来提升识别率和准确率（这部分是我目前不具备的能力），现在有些用户用了自己的字体识别不出来，由于是用api，所以并不能解决这个问题 可以加上会议签到等功能，考勤汇总什么的就没有那么辛苦，本人不是很想一个人完成这些所有功能，实在太累了，就交给后面的大佬来实现了 #####最后附上当时想做成小程序的供需分析 （我分析了然后，为什么自己不做呢，是由于，我还不想花时间去研究get/post请求与小程序界面的链接，决定简化自己操作，用自己已知大部分的知识缩短开发时间，所以就写了个网站） 上述书于2020.11.03，若有补充后续再说 ","link":"https://riddler11.github.io/post/xue-xi-qiang-guo-da-qia-xi-tong/"},{"title":"nodemcu/ESP12F土壤湿度传感器使用效果及代码详解","content":"首先附上效果图，为了方便调试书写代码，本人用arduino IDE来书写代码。 窗口监视器打印实时效果 硬件是我自己画板交给商家制作的，下图是我实际硬件图 ####我所使用的土壤湿度传感器 ####引脚如图某宝详情 ##土壤湿度传感器与nodemcu接线（ESP12F/ESP8266也可参考） ##代码中所读取的是模拟信号值，其实只用接AO，GND，VCC三个引脚 ##接下来是代码部分： CSDN下载代码 ","link":"https://riddler11.github.io/post/nodemcuesp12f-tu-rang-shi-du-chuan-gan-qi-shi-yong-xiao-guo-ji-dai-ma-xiang-jie/"},{"title":"nodemcu/ESP12F贝壳物联实时监控环境温度","content":"nodemcu/ESP12F贝壳物联实时监控环境温度 贝壳物联效果图如下： 实现思路 先联网 连上贝壳物联 定时发送信息 我本人查找了很多资料，没有发现实际有效的资料能够辅助我完成。 于是我自己看文档借助贝壳物联的控制代码进行改造成传信息的代码。 可能是全网首创非lua的C语言代码。 关键代码： 代码详解视频 点击前往CSDN下载代码 ","link":"https://riddler11.github.io/post/nodemcuesp12f-bei-ke-wu-lian-shi-shi-jian-kong-huan-jing-wen-du/"}]}